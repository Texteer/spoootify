<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spotify Clone - Full Features</title>
<style>
/* ===== BODY ===== */
body { margin:0; font-family:Arial,sans-serif; background:#121212; color:white; overflow-x:hidden; transition:0.3s;}
body.light { background:#f5f5f5; color:#121212; }
/* ===== HEADER ===== */
.header { position:relative; height:300px; display:flex; align-items:flex-end; padding:20px; background-size:cover; background-position:center; transition:0.5s;}
.header::after { content:""; position:absolute; inset:0; background:linear-gradient(to top,rgba(0,0,0,0.8),rgba(0,0,0,0.3)); transition:0.5s;}
.header h1 { position:relative; font-size:3rem; margin:0; z-index:1; }
/* ===== SEARCH ===== */
.search-bar { margin:20px; }
.search-bar input { width:100%; padding:10px; border-radius:30px; border:none; outline:none; font-size:16px; }
/* ===== SONG LIST ===== */
.song-list { margin:20px; }
.song-list h2 { position:sticky; top:0; background:inherit; padding:10px 0; z-index:2; }
.song { display:grid; grid-template-columns:30px 1fr 100px 60px; align-items:center; padding:8px; cursor:pointer; border-radius:6px; transition:0.2s;}
.song:hover { background:rgba(255,255,255,0.1); }
.song.playing { background:rgba(29,185,84,0.2); }
.playing-icon { color:#1db954; font-size:14px; }
/* ===== ARTIST PICK ===== */
.artist-pick { margin:20px; display:flex; align-items:center; gap:15px; background:rgba(255,255,255,0.05); padding:15px; border-radius:12px; transition:0.3s;}
body.light .artist-pick { background:rgba(0,0,0,0.05);}
.artist-pick img { width:80px; height:80px; border-radius:8px; object-fit:cover; }
.artist-pick button { background:#1db954; border:none; padding:10px 20px; border-radius:30px; cursor:pointer; transition:0.2s;}
.artist-pick button:hover { background:#1ed760; }
/* ===== PLAYER ===== */
.player { position:fixed; bottom:0; left:0; right:0; background:#181818; display:flex; flex-direction:column; padding:10px 20px; z-index:999; transition:0.3s;}
body.light .player { background:#e5e5e5; color:#121212;}
.controls { display:flex; justify-content:center; align-items:center; gap:15px; margin-bottom:5px; }
.controls button { background:none; border:none; color:inherit; font-size:20px; cursor:pointer; transition:0.2s; }
.controls button:hover { transform:scale(1.2); }
.seek-bar { width:100%; appearance:none; height:4px; background:#404040; border-radius:2px; cursor:pointer; transition:width 0.2s linear;}
.seek-bar::-webkit-slider-thumb { appearance:none; width:12px; height:12px; border-radius:50%; background:#1db954; cursor:pointer;}
.volume { display:flex; align-items:center; gap:10px; margin-top:5px;}
.volume input { width:100px;}
.heart { cursor:pointer; color:gray; transition:0.2s;}
.heart.favorited { color:#1db954;}
.playlist { margin:20px;}
.playlist h2 { margin-bottom:10px;}
.playlist div { padding:5px 0; display:flex; justify-content:space-between; }
.playlist div span { cursor:pointer; }
.theme-toggle { position:fixed; top:20px; right:20px; cursor:pointer; font-size:20px; }
/* ===== VISUALIZER ===== */
#visualizer { width:100%; display:block; height:100px; }
</style>
</head>
<body>

<div class="header" id="header" style="background-image:url('assets/background.jpg')">
<h1 id="artist-name">Lady Gaga</h1>
</div>

<div class="theme-toggle" id="themeToggle">üåô</div>

<div class="search-bar">
<input type="text" id="searchInput" placeholder="Search songs or artists...">
</div>

<div class="song-list">
<h2>Popular</h2>
<div id="songs"></div>
</div>

<div class="artist-pick">
<img src="assets/pick-cover.jpg" alt="pick cover">
<div>
<h3>Artist‚Äôs Pick</h3>
<button id="pickPlay">‚ñ∂ Play Pick</button>
</div>
</div>

<div class="playlist">
<h2>Your Playlist</h2>
<div id="playlist"></div>
</div>

<div class="player">
<div class="controls">
<button id="shuffle">üîÄ</button>
<button id="prev">‚èÆ</button>
<button id="playPause">‚ñ∂</button>
<button id="next">‚è≠</button>
<button id="repeat">üîÅ</button>
</div>
<input type="range" id="seek" value="0" class="seek-bar">
<div class="volume">
üîä <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
<button id="muteBtn">üîá</button>
</div>
<div id="timeDisplay" style="text-align:center;margin-top:5px;"></div>
<canvas id="visualizer"></canvas>
</div>

<script>
/* ===== SONG DATA ===== */
const songs=[
{ title:"Die With A Smile", artist:"Lady Gaga", streams:"2,944,087,425", length:"4:11", cover:"assets/cover1.jpg", file:"assets/song1.mp3"},
{ title:"Poker Face", artist:"Lady Gaga", streams:"1,847,477,442", length:"3:57", cover:"assets/cover2.jpg", file:"assets/song2.mp3"}
];

/* ===== AUDIO SETUP ===== */
const audio=new Audio(); audio.volume=1;
let currentSong=0, isPlaying=false, shuffle=false, repeat="off", playlistQueue=[];

/* ===== DOM ELEMENTS ===== */
const songsContainer=document.getElementById("songs");
const playlistContainer=document.getElementById("playlist");
const playPause=document.getElementById("playPause");
const seek=document.getElementById("seek");
const volume=document.getElementById("volume");
const shuffleBtn=document.getElementById("shuffle");
const repeatBtn=document.getElementById("repeat");
const prevBtn=document.getElementById("prev");
const nextBtn=document.getElementById("next");
const pickPlay=document.getElementById("pickPlay");
const header=document.getElementById("header");
const searchInput=document.getElementById("searchInput");
const muteBtn=document.getElementById("muteBtn");
const themeToggle=document.getElementById("themeToggle");
const timeDisplay=document.getElementById("timeDisplay");
const canvas=document.getElementById("visualizer"); const ctx=canvas.getContext("2d");
const audioCtx=new (window.AudioContext||window.webkitAudioContext)(); const analyser=audioCtx.createAnalyser(); let source;

/* ===== RENDER SONG LIST ===== */
function renderSongs(list=songs){
songsContainer.innerHTML="";
list.forEach((s,i)=>{
  const div=document.createElement("div"); div.classList.add("song");
  if(i===currentSong) div.classList.add("playing");
  div.innerHTML=`<div class="playing-icon">${i===currentSong&&isPlaying?"‚ñ∂":""}</div>
                 <div>${s.title} - ${s.artist}</div>
                 <div>${s.streams}</div>
                 <div>${s.length}</div>`;
  const heart=document.createElement("span"); heart.innerHTML="‚ô•"; heart.classList.add("heart");
  heart.onclick=e=>{e.stopPropagation(); heart.classList.toggle("favorited"); };
  const queueBtn=document.createElement("span"); queueBtn.textContent="‚ûï"; queueBtn.style.cursor="pointer"; queueBtn.onclick=e=>{e.stopPropagation(); addToQueue(i);}
  div.appendChild(heart); div.appendChild(queueBtn);
  div.ondblclick=()=>playSong(i); div.onclick=()=>currentSong=i;
  div.addEventListener("mouseenter",()=>{const preview=new Audio(s.file); preview.currentTime=0; preview.volume=0.2; preview.play(); div.previewAudio=preview;});
  div.addEventListener("mouseleave",()=>{if(div.previewAudio){div.previewAudio.pause(); div.previewAudio=null;}});
  songsContainer.appendChild(div);
});
}

/* ===== PLAY SONG ===== */
function playSong(i){
currentSong=i; const song=songs[i]; audio.src=song.file; audio.load();
audio.play().then(()=>{isPlaying=true; updateUI();}).catch(console.error);
header.style.backgroundImage=`url('${song.cover}')`;
}

/* ===== TOGGLE PLAY ===== */
function togglePlay(){ if(!audio.src) return playSong(currentSong); if(isPlaying){audio.pause(); isPlaying=false;} else{audio.play().catch(console.error); isPlaying=true;} updateUI(); }

/* ===== UPDATE UI ===== */
function updateUI(){ playPause.textContent=isPlaying?"‚è∏":"‚ñ∂"; renderSongs(); renderPlaylist(); }

/* ===== PLAYLIST ===== */
function renderPlaylist(){ playlistContainer.innerHTML=""; playlistQueue.forEach((s,i)=>{ const div=document.createElement("div"); div.innerHTML=`${s.title} - ${s.artist} <span onclick="removeFromPlaylist(${i})">‚ùå</span>`; playlistContainer.appendChild(div); }); }
function removeFromPlaylist(i){ playlistQueue.splice(i,1); renderPlaylist(); }
function addToQueue(i){ playlistQueue.splice(1,0,songs[i]); renderPlaylist(); }

/* ===== EVENTS ===== */
playPause.onclick=togglePlay;
volume.oninput=()=>audio.volume=volume.value;
seek.oninput=()=>audio.currentTime=(seek.value/100)*audio.duration;
shuffleBtn.onclick=()=>{shuffle=!shuffle; shuffleBtn.style.color=shuffle?"#1db954":"white";}
repeatBtn.onclick=()=>{if(repeat==="off"){repeat="all";repeatBtn.textContent="üîÇ";} else if(repeat==="all"){repeat="one";repeatBtn.textContent="üîÅ1";} else{repeat="off";repeatBtn.textContent="üîÅ";}}
prevBtn.onclick=()=>audio.currentTime>5?audio.currentTime=0:playSong((currentSong-1+songs.length)%songs.length);
nextBtn.onclick=()=>crossfadeTo((currentSong+1)%songs.length);
pickPlay.onclick=()=>playSong(0);
muteBtn.onclick=()=>{audio.muted=!audio.muted; muteBtn.textContent=audio.muted?"üîà":"üîá";}
searchInput.oninput=()=>{ const term=searchInput.value.toLowerCase(); renderSongs(songs.filter(s=>s.title.toLowerCase().includes(term)||s.artist.toLowerCase().includes(term))); }
themeToggle.onclick=()=>{document.body.classList.toggle("light"); themeToggle.textContent=document.body.classList.contains("light")?"üåô":"üåû";}

/* ===== KEYBOARD SHORTCUTS ===== */
document.addEventListener("keydown",e=>{ if(e.code==="Space"){e.preventDefault();togglePlay();}
else if(e.code==="ArrowRight") audio.currentTime+=5;
else if(e.code==="ArrowLeft") audio.currentTime-=5;
else if(e.code==="ArrowUp") playSong((currentSong-1+songs.length)%songs.length);
else if(e.code==="ArrowDown") crossfadeTo((currentSong+1)%songs.length);
});

/* ===== CROSSFADE ===== */
const crossfadeDuration=2; let fadeOutInterval, fadeInInterval;
function crossfadeTo(nextIndex){
  const nextAudio=new Audio(songs[nextIndex].file); nextAudio.volume=0; nextAudio.play().then(()=>{
    let fadeStep=0.05;
    fadeOutInterval=setInterval(()=>{ audio.volume=Math.max(0,audio.volume-fadeStep); if(audio.volume<=0){ clearInterval(fadeOutInterval); audio.pause(); audio.currentTime=0; }}, crossfadeDuration*50);
    fadeInInterval=setInterval(()=>{ nextAudio.volume=Math.min(1,nextAudio.volume+fadeStep); if(nextAudio.volume>=1){ clearInterval(fadeInInterval); audio.src=nextAudio.src; audio.currentTime=nextAudio.currentTime; audio.volume=1; audio.play(); }}, crossfadeDuration*50);
  }).catch(console.error);
  currentSong=nextIndex; header.style.backgroundImage=`url('${songs[nextIndex].cover}')`; updateUI();
}

/* ===== VISUALIZER ===== */
audio.addEventListener("play", ()=>{
  if(!source){ source=audioCtx.createMediaElementSource(audio); source.connect(analyser); analyser.connect(audioCtx.destination);}
  drawVisualizer();
});
function drawVisualizer(){ requestAnimationFrame(drawVisualizer); analyser.fftSize=64; const bufferLength=analyser.frequencyBinCount; const dataArray=new Uint8Array(bufferLength); analyser.getByteFrequencyData(dataArray); ctx.clearRect(0,0,canvas.width,canvas.height); const barWidth=(canvas.width/bufferLength); dataArray.forEach((value,i)=>{ const barHeight=value; ctx.fillStyle='#1db954'; ctx.fillRect(i*barWidth,canvas.height-barHeight/2,barWidth-2,barHeight/2); });}

/* ===== TIME DISPLAY ===== */
audio.ontimeupdate=()=>{
  seek.value=(audio.currentTime/audio.duration)*100||0;
  const elapsed=Math.floor(audio.currentTime);
  const duration=Math.floor(audio.duration)||0;
  const format=sec=>`${Math.floor(sec/60)}:${String(sec%60).padStart(2,'0')}`;
  timeDisplay.textContent=`${format(elapsed)} / ${format(duration)}`;
}

/* ===== INIT ===== */
renderSongs();
renderPlaylist();
</script>

</body>
</html>
